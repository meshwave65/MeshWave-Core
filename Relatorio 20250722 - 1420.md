Relatório de Situação e Consolidação de Conceitos – Projeto MeshWave
Data: 22 de julho de 2025
Foco: Fundação e Integração (FASE 1) do Protótipo Android (MeshWave-Core)
Status: Estrutura de projeto sendo criada por agente. Arquitetura de software redefinida e alinhada com a visão do projeto.
1. Visão Macro Consolidada
Ficou estabelecido que o MeshWave-Core não é um aplicativo isolado, mas sim a implementação da fundação da Fase 1 do ecossistema MeshWave para a plataforma Android. Cada decisão de arquitetura deve servir não apenas às necessidades imediatas de conectividade, mas também como alicerce para as fases futuras de descentralização, IA e tecnologias emergentes, conforme o roadmap do projeto. O desenvolvimento adota uma filosofia de resiliência, especialização de módulos e tratamento de falhas como estados operacionais previstos.
2. Arquitetura de Identidade: O Endereço Roteável (MWA)
O conceito fundamental consolidado é que a identidade de um nó na rede MeshWave não é um simples identificador, mas um endereço hierárquico e roteável, o MWA (MeshWave Address).
Estrutura: Continente.País.Estado.Cidade.CPA.Username
Exemplo: SA.BR.RJ.RIO.CPA00.User001
Função: Esta estrutura é a chave para o roteamento otimizado. Ela permite que a rede tome decisões de roteamento inteligentes sem a necessidade de consultar um servidor central. Uma consulta por um nó na mesma cidade não precisa escalar para o cache continental.
3. Arquitetura de Caches: Hierarquia Federada e Distribuída
Consolidamos o entendimento de que a rede opera sobre uma hierarquia de caches federados. A busca por um recurso ou nó sempre começa no nível mais baixo e local, escalando apenas quando necessário.
Hierarquia:
Cache Temporário (Local): Interações mais recentes.
CLA_CACHE (Cache de Localização Atualizada): "Painel de Controle" dos nós atualmente na mesma área geográfica (Geohash nível 6). Contém dados operacionais ricos.
CPA_CACHE (Cache Primário de Atualização): "Cartório" da rede. Contém a "Certidão de Nascimento" imutável de cada nó e um ponteiro para sua localização atual na rede. É um cache replicado entre os membros da CPA.
Caches Superiores (Regional, País, Continental): Agregadores que apontam para os caches do nível inferior, permitindo o roteamento em larga escala.
Princípio Operacional: Otimização e eficiência. A rede evita sobrecarga nos níveis superiores resolvendo 99% das requisições nos níveis mais baixos e locais possíveis.
4. Separação de Responsabilidades dos Dados
Para implementar a arquitetura acima, definimos três data class primárias, cada uma com uma responsabilidade clara e especializada:
MeshWaveAddress: Modela a identidade roteável (MWA). É o "endereço" de um nó.
CpaRecord: Modela o registro no "Cartório" (CPA_CACHE). Contém os dados de identidade imutáveis e os ponteiros de estado transitórios.
ClaNodeProfile: Modela o perfil operacional rico de um nó dentro de uma CLA. Contém dados voláteis e detalhados (nível de bateria, rank de credibilidade, funções ativas, etc.).
Esta separação elimina a sobrecarga do antigo NodeCPA monolítico e permite que cada módulo do sistema opere apenas com os dados que lhe são pertinentes.
5. Estratégia de Resiliência e "Default-Fails"
Consolidamos o princípio de que falhas não são exceções, mas estados operacionais. O sistema deve ser projetado para operar em modo degradado de forma transparente para o usuário.
GeoHashes de Falha: g6fail e g9fail não são apenas strings de erro, mas dados válidos que representam um estado de falha conhecido. A UI deve reagir a eles, por exemplo, exibindo a informação em vermelho.
Lógica de TTL (Time-To-Live): O sistema de cores (Verde, Amarelo, Vermelho) para a "saúde" da informação foi consolidado. Ele se baseia não apenas no sucesso/falha da obtenção do dado, mas na sua idade (timestamp), permitindo que o sistema identifique e sinalize dados desatualizados (STALE) antes que se tornem inválidos (FAILED).
Sincronização Inteligente: A lógica de atualização de caches não é uma simples substituição. Ela envolve a comparação de timestamps e a validade dos dados, permitindo que um nó com um dado mais antigo, porém válido, seja mantido em detrimento de uma atualização de "falha" recebida da rede.
6. Situação Atual do Código e Próximos Passos
Ação em Andamento: Um agente está criando a estrutura de diretórios e arquivos de build para um projeto MeshWave-Core limpo e funcional.
Próximo Passo Imediato (Pós-Agente):
Popular a estrutura do projeto com os arquivos de modelo de dados definidos (MeshWaveAddress, CpaRecord, ClaNodeProfile).
Adicionar os arquivos de configuração básicos (AndroidManifest.xml, Theme.kt, etc.).
Obter um "BUILD SUCCESSFUL" com uma MainActivity mínima.
Próximo Passo (Desenvolvimento): Iniciar a reconstrução dos módulos de gerenciamento (CpaManager, ClaCache, LocationModule, MainViewModel), um de cada vez, de forma homeopática, garantindo que cada um utilize a nova arquitetura de dados e que o projeto compile a cada passo.
Este relatório representa nosso alinhamento. A partir de agora, todas as nossas ações de desenvolvimento serão guiadas por estes princípios consolidados.
